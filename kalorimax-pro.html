<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🌟 KaloriMax Pro 2.0 - Ultimate Beslenme Takibi</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --warning-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --dark-bg: #1a1a2e;
            --dark-card: #16213e;
            --dark-text: #ffffff;
            --dark-text-secondary: #e94560;
            --light-bg: #f8f9fa;
            --light-card: rgba(255, 255, 255, 0.95);
            --light-text: #333;
            --light-text-secondary: #666;
        }

        [data-theme="dark"] {
            --bg-color: var(--dark-bg);
            --card-color: var(--dark-card);
            --text-color: var(--dark-text);
            --text-secondary: var(--dark-text-secondary);
            --input-bg: rgba(255, 255, 255, 0.1);
            --input-text: #ffffff;
            --input-placeholder: rgba(255, 255, 255, 0.6);
            --border-color: rgba(255, 255, 255, 0.2);
            --hover-bg: rgba(255, 255, 255, 0.15);
        }

        [data-theme="light"] {
            --bg-color: var(--light-bg);
            --card-color: var(--light-card);
            --text-color: var(--light-text);
            --text-secondary: var(--light-text-secondary);
            --input-bg: rgba(255, 255, 255, 0.9);
            --input-text: #333;
            --input-placeholder: rgba(0, 0, 0, 0.6);
            --border-color: rgba(0, 0, 0, 0.1);
            --hover-bg: rgba(0, 0, 0, 0.05);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-color, var(--primary-gradient));
            color: var(--text-color, white);
            min-height: 100vh;
            transition: all 0.3s ease;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* HEADER */
        .header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #fff, #f0f0f0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }

        /* THEME TOGGLE */
        .theme-toggle {
            position: absolute;
            top: 0;
            right: 0;
            background: rgba(255,255,255,0.2);
            border: none;
            padding: 10px 15px;
            border-radius: 25px;
            color: white;
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.05);
        }

        /* USER PROFILE SECTION */
        .profile-section {
            background: var(--card-color, rgba(255,255,255,0.15));
            padding: 25px;
            border-radius: 20px;
            margin-bottom: 30px;
            backdrop-filter: blur(15px);
            border: 1px solid var(--border-color);
        }

        .profile-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            margin-bottom: 5px;
            font-weight: 600;
        }

        .form-group input, .form-group select {
            padding: 10px;
            border: none;
            border-radius: 10px;
            background: var(--input-bg);
            color: var(--input-text);
            backdrop-filter: blur(10px);
        }

        .form-group input::placeholder {
            color: var(--input-placeholder);
        }

        /* TAB NAVIGATION */
        .tab-navigation {
            display: flex;
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 5px;
            margin-bottom: 30px;
            backdrop-filter: blur(15px);
        }

        .tab-btn {
            flex: 1;
            padding: 15px 20px;
            border: none;
            background: transparent;
            color: white;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .tab-btn.active {
            background: var(--secondary-gradient);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transform: translateY(-2px);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* DASHBOARD CARDS */
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--card-color, rgba(255,255,255,0.15));
            padding: 25px;
            border-radius: 20px;
            text-align: center;
            backdrop-filter: blur(15px);
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 10px;
            background: var(--secondary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-label {
            font-size: 1rem;
            opacity: 0.8;
            margin-bottom: 10px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.2);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--success-gradient);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        /* SEARCH AND ADD SECTION */
        .search-section {
            background: var(--card-color, rgba(255,255,255,0.15));
            padding: 25px;
            border-radius: 20px;
            margin-bottom: 30px;
            backdrop-filter: blur(15px);
            border: 1px solid var(--border-color);
        }

        .search-container {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .search-input {
            flex: 1;
            min-width: 300px;
            padding: 15px 20px;
            border: none;
            border-radius: 25px;
            background: var(--input-bg);
            color: var(--input-text);
            font-size: 1rem;
            backdrop-filter: blur(10px);
        }

        .search-input::placeholder {
            color: var(--input-placeholder);
        }

        .category-filter {
            padding: 15px 20px;
            border: none;
            border-radius: 25px;
            background: var(--input-bg);
            color: var(--input-text);
            cursor: pointer;
            backdrop-filter: blur(10px);
        }

        .btn {
            padding: 15px 25px;
            border: none;
            border-radius: 25px;
            background: var(--secondary-gradient);
            color: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        .btn-primary { background: var(--primary-gradient); }
        .btn-success { background: var(--success-gradient); }
        .btn-warning { background: var(--warning-gradient); }

        /* FOOD RESULTS */
        .food-results {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .food-item {
            background: var(--hover-bg);
            padding: 20px;
            border-radius: 15px;
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .food-item:hover {
            transform: translateY(-3px);
            background: var(--hover-bg);
        }

        .food-name {
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .favorite-btn {
            background: none;
            border: none;
            color: #ffd700;
            cursor: pointer;
            font-size: 1.2rem;
        }

        .nutrition-info {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin-bottom: 15px;
            font-size: 0.9rem;
        }

        .amount-input {
            width: 80px;
            padding: 8px;
            border: none;
            border-radius: 8px;
            background: var(--input-bg);
            color: var(--input-text);
            text-align: center;
        }

        /* FOOD HISTORY */
        .food-history {
            background: var(--card-color, rgba(255,255,255,0.15));
            padding: 25px;
            border-radius: 20px;
            backdrop-filter: blur(15px);
            border: 1px solid var(--border-color);
        }

        .history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background: var(--hover-bg);
            border-radius: 10px;
            border: 1px solid var(--border-color);
        }

        .history-details {
            flex: 1;
        }

        .history-nutrition {
            display: flex;
            gap: 15px;
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .delete-btn {
            background: none;
            border: none;
            color: #ff6b6b;
            cursor: pointer;
            font-size: 1.2rem;
            padding: 5px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .delete-btn:hover {
            background: rgba(255,107,107,0.2);
        }

        /* WATER TRACKING */
        .water-tracker {
            background: var(--success-gradient);
            padding: 25px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 20px;
        }

        .water-cups {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .water-cup {
            width: 40px;
            height: 40px;
            border: 2px solid white;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .water-cup.filled {
            background: white;
            color: #4facfe;
        }

        .water-cup:hover {
            transform: scale(1.1);
        }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            .container { padding: 10px; }
            .header h1 { font-size: 2rem; }
            .dashboard { grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); }
            .search-container { flex-direction: column; }
            .search-input { min-width: 100%; }
            .tab-navigation { flex-direction: column; }
            .profile-form { grid-template-columns: 1fr; }
        }

        /* ANIMATIONS */
        @keyframes slideInUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .animate-in {
            animation: slideInUp 0.5s ease-out;
        }

        /* CHARTS */
        .chart-container {
            background: var(--card-color, rgba(255,255,255,0.15));
            padding: 25px;
            border-radius: 20px;
            margin-bottom: 30px;
            backdrop-filter: blur(15px);
            border: 1px solid var(--border-color);
        }

        .macro-chart {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
        }

        .macro-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            background: conic-gradient(
                #ff6b6b 0deg 90deg,
                #4ecdc4 90deg 180deg,
                #45b7d1 180deg 270deg,
                #96ceb4 270deg 360deg
            );
        }

        .macro-center {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: var(--card-color, rgba(255,255,255,0.9));
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            color: var(--text-color, #333);
        }
    </style>
</head>
<body data-theme="light">
    <div class="container">
        <!-- HEADER -->
        <header class="header">
            <button class="theme-toggle" onclick="toggleTheme()">🌙 / ☀️</button>
            <h1>🌟 KaloriMax Pro 2.0</h1>
            <p>Ultimate Beslenme Takibi - 3000+ Besin | Markalar | Profesyonel Takip</p>
        </header>

        <!-- USER PROFILE SECTION -->
        <div class="profile-section">
            <h3>👤 Kullanıcı Profili & Otomatik Hedef Hesaplama</h3>
            <div class="profile-form">
                <div class="form-group">
                    <label>Ad</label>
                    <input type="text" id="userName" placeholder="Adınız">
                </div>
                <div class="form-group">
                    <label>Yaş</label>
                    <input type="number" id="userAge" placeholder="25">
                </div>
                <div class="form-group">
                    <label>Cinsiyet</label>
                    <select id="userGender">
                        <option value="male">Erkek</option>
                        <option value="female">Kadın</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Boy (cm)</label>
                    <input type="number" id="userHeight" placeholder="175">
                </div>
                <div class="form-group">
                    <label>Kilo (kg)</label>
                    <input type="number" id="userWeight" placeholder="70">
                </div>
                <div class="form-group">
                    <label>Aktivite Seviyesi</label>
                    <select id="activityLevel">
                        <option value="1.2">Sedanter (masa başı)</option>
                        <option value="1.375">Hafif aktif (haftada 1-3 gün)</option>
                        <option value="1.55">Orta aktif (haftada 3-5 gün)</option>
                        <option value="1.725">Çok aktif (haftada 6-7 gün)</option>
                        <option value="1.9">Ekstrem aktif (günde 2 kez)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Hedef</label>
                    <select id="goal">
                        <option value="maintain">Kilo Koruma</option>
                        <option value="lose">Kilo Verme (-0.5kg/hafta)</option>
                        <option value="gain">Kilo Alma (+0.5kg/hafta)</option>
                    </select>
                </div>
            </div>
            <button class="btn btn-success" onclick="calculateTargets()">🎯 Hedefleri Hesapla</button>
        </div>

        <!-- WATER TRACKER -->
        <div class="water-tracker">
            <h3>💧 Su Takibi</h3>
            <p>Günlük hedef: 8 bardak (2L)</p>
            <div class="water-cups" id="waterCups">
                <!-- Su bardakları dinamik oluşturulacak -->
            </div>
            <p><span id="waterCount">0</span> / 8 bardak içildi</p>
        </div>

        <!-- TAB NAVIGATION -->
        <nav class="tab-navigation">
            <button class="tab-btn active" onclick="openTab('dashboard')">📊 Dashboard</button>
            <button class="tab-btn" onclick="openTab('search')">🔍 Besin Ekle</button>
            <button class="tab-btn" onclick="openTab('favorites')">⭐ Favoriler</button>
            <button class="tab-btn" onclick="openTab('stats')">📈 İstatistikler</button>
            <button class="tab-btn" onclick="openTab('settings')">⚙️ Ayarlar</button>
        </nav>

        <!-- DASHBOARD TAB -->
        <div id="dashboard" class="tab-content active">
            <div class="dashboard">
                <div class="stat-card">
                    <div class="stat-number" id="totalCalories">0</div>
                    <div class="stat-label">Kalori</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="calorieProgress"></div>
                    </div>
                    <div style="margin-top: 10px;">
                        <span id="calorieTarget" onclick="editCalorieTarget()" style="cursor: pointer; text-decoration: underline;">2000</span> hedef
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalProtein">0</div>
                    <div class="stat-label">Protein (g)</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="proteinProgress"></div>
                    </div>
                    <div style="margin-top: 10px;"><span id="proteinTarget">150</span>g hedef</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalCarbs">0</div>
                    <div class="stat-label">Karbonhidrat (g)</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="carbProgress"></div>
                    </div>
                    <div style="margin-top: 10px;"><span id="carbTarget">250</span>g hedef</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalFat">0</div>
                    <div class="stat-label">Yağ (g)</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="fatProgress"></div>
                    </div>
                    <div style="margin-top: 10px;"><span id="fatTarget">65</span>g hedef</div>
                </div>
            </div>

            <!-- MACRO CHART -->
            <div class="chart-container">
                <h3>📊 Makro Dağılımı</h3>
                <div class="macro-chart">
                    <div class="macro-circle">
                        <div class="macro-center">
                            <strong id="totalCaloriesChart">0</strong>
                            <small>kalori</small>
                        </div>
                    </div>
                </div>
                <div style="display: flex; justify-content: space-around; margin-top: 20px;">
                    <div style="text-align: center;">
                        <div style="color: #ff6b6b;">●</div>
                        <small>Protein</small>
                    </div>
                    <div style="text-align: center;">
                        <div style="color: #4ecdc4;">●</div>
                        <small>Karbonhidrat</small>
                    </div>
                    <div style="text-align: center;">
                        <div style="color: #45b7d1;">●</div>
                        <small>Yağ</small>
                    </div>
                </div>
            </div>

            <!-- FOOD HISTORY -->
            <div class="food-history">
                <h3>🍽️ Bugünkü Yemekler</h3>
                <div id="foodList"></div>
            </div>
        </div>

        <!-- SEARCH TAB -->
        <div id="search" class="tab-content">
            <div class="search-section">
                <h3>🔍 Besin Arama & Ekleme</h3>
                <div class="search-container">
                    <input type="text" id="foodSearch" class="search-input" 
                           placeholder="🔍 Besin ara... (örn: tavuk göğsü, nutella, big mac, ülker)">
                    <select id="categoryFilter" class="category-filter">
                        <option value="">Tüm Kategoriler</option>
                        <option value="Et">🥩 Et Ürünleri</option>
                        <option value="Tavuk">🍗 Tavuk</option>
                        <option value="Balık">🐟 Balık</option>
                        <option value="Süt">🥛 Süt Ürünleri</option>
                        <option value="Meyve">🍎 Meyveler</option>
                        <option value="Sebze">🥬 Sebzeler</option>
                        <option value="Tahıl">🌾 Tahıllar</option>
                        <option value="McDonald's">🍔 McDonald's</option>
                        <option value="KFC">🍗 KFC</option>
                        <option value="Nutella">🍫 Nutella</option>
                        <option value="Coca-Cola">🥤 Coca-Cola</option>
                    </select>
                    <button class="btn btn-primary" onclick="searchFood()">Ara</button>
                </div>
                
                <div class="food-results" id="searchResults"></div>
            </div>
        </div>

        <!-- FAVORITES TAB -->
        <div id="favorites" class="tab-content">
            <div class="search-section">
                <h3>⭐ Favori Besinler</h3>
                <div class="food-results" id="favoritesList"></div>
            </div>
        </div>

        <!-- STATISTICS TAB -->
        <div id="stats" class="tab-content">
            <div class="chart-container">
                <h3>📈 Haftalık İstatistikler</h3>
                <p>Yakında eklenecek: Haftalık kalori grafikleri, protein hedefi başarısı, en çok yenen besinler</p>
            </div>
        </div>

        <!-- SETTINGS TAB -->
        <div id="settings" class="tab-content">
            <div class="search-section">
                <h3>⚙️ Ayarlar</h3>
                <div class="profile-form">
                    <div class="form-group">
                        <label>Tema</label>
                        <select id="themeSelect" onchange="changeTheme()">
                            <option value="light">🌞 Açık Tema</option>
                            <option value="dark">🌙 Koyu Tema</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Birim Sistemi</label>
                        <select>
                            <option value="metric">Metrik (kg, cm)</option>
                            <option value="imperial">İmperial (lb, ft)</option>
                        </select>
                    </div>
                </div>
                <button class="btn btn-warning" onclick="exportData()">📄 Verileri Dışa Aktar</button>
                <button class="btn btn-warning" onclick="clearAllData()" style="margin-left: 10px;">🗑️ Tüm Verileri Sil</button>
            </div>
        </div>
    </div>

    <script>
        // TEMA YÖNETİMİ
        let currentTheme = localStorage.getItem('theme') || 'light';
        
        function toggleTheme() {
            currentTheme = currentTheme === 'light' ? 'dark' : 'light';
            applyTheme();
            localStorage.setItem('theme', currentTheme);
        }
        
        function changeTheme() {
            currentTheme = document.getElementById('themeSelect').value;
            applyTheme();
            localStorage.setItem('theme', currentTheme);
        }
        
        function applyTheme() {
            document.body.setAttribute('data-theme', currentTheme);
            document.getElementById('themeSelect').value = currentTheme;
            
            // Tema toggle butonunun metnini güncelle
            const themeToggle = document.querySelector('.theme-toggle');
            if (currentTheme === 'dark') {
                themeToggle.textContent = '☀️';
            } else {
                themeToggle.textContent = '🌙';
            }
        }
        
        // Sayfa yüklendiğinde temayı uygula
        document.addEventListener('DOMContentLoaded', function() {
            applyTheme();
            initializeWaterTracker();
            loadFoodHistory();
            loadFavorites();
            updateDashboard();
        });
        
        // SU TAKİBİ
        function initializeWaterTracker() {
            const waterCupsContainer = document.getElementById('waterCups');
            waterCupsContainer.innerHTML = '';
            
            for (let i = 0; i < 8; i++) {
                const cup = document.createElement('div');
                cup.className = 'water-cup';
                cup.onclick = () => toggleWaterCup(i);
                waterCupsContainer.appendChild(cup);
            }
            
            loadWaterCount();
        }
        
        function toggleWaterCup(index) {
            const cups = document.querySelectorAll('.water-cup');
            const currentCount = parseInt(document.getElementById('waterCount').textContent);
            
            if (index < currentCount) {
                // Bardakları boşalt
                for (let i = index; i < cups.length; i++) {
                    cups[i].classList.remove('filled');
                }
                document.getElementById('waterCount').textContent = index;
            } else {
                // Bardakları doldur
                for (let i = 0; i <= index; i++) {
                    cups[i].classList.add('filled');
                }
                document.getElementById('waterCount').textContent = index + 1;
            }
            
            localStorage.setItem('waterCount', document.getElementById('waterCount').textContent);
        }
        
        function loadWaterCount() {
            const savedCount = localStorage.getItem('waterCount') || '0';
            const count = parseInt(savedCount);
            document.getElementById('waterCount').textContent = count;
            
            const cups = document.querySelectorAll('.water-cup');
            cups.forEach((cup, index) => {
                if (index < count) {
                    cup.classList.add('filled');
                } else {
                    cup.classList.remove('filled');
                }
            });
        }
        
        // TAB YÖNETİMİ
        function openTab(tabName) {
            // Tüm tab içeriklerini gizle
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.classList.remove('active'));
            
            // Tüm tab butonlarını pasif yap
            const tabButtons = document.querySelectorAll('.tab-btn');
            tabButtons.forEach(btn => btn.classList.remove('active'));
            
            // Seçilen tabı göster
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }
        
        // BESİN VERİTABANI
        const foodDatabase = {
            "tavuk göğsü": { name: "Tavuk Göğsü", calories: 165, protein: 31, carbs: 0, fat: 3.6, category: "Tavuk" },
            "nutella": { name: "Nutella", calories: 539, protein: 6.3, carbs: 57.5, fat: 30.9, category: "Nutella" },
            "big mac": { name: "Big Mac", calories: 550, protein: 25, carbs: 45, fat: 30, category: "McDonald's" },
            "coca cola": { name: "Coca-Cola", calories: 42, protein: 0, carbs: 10.6, fat: 0, category: "Coca-Cola" },
            "elma": { name: "Elma", calories: 52, protein: 0.3, carbs: 14, fat: 0.2, category: "Meyve" },
            "muz": { name: "Muz", calories: 89, protein: 1.1, carbs: 23, fat: 0.3, category: "Meyve" },
            "süt": { name: "Süt", calories: 42, protein: 3.4, carbs: 5, fat: 1, category: "Süt" },
            "yumurta": { name: "Yumurta", calories: 155, protein: 13, carbs: 1.1, fat: 11, category: "Et" },
            "pirinç": { name: "Pirinç", calories: 130, protein: 2.7, carbs: 28, fat: 0.3, category: "Tahıl" },
            "ekmek": { name: "Ekmek", calories: 265, protein: 9, carbs: 49, fat: 3.2, category: "Tahıl" }
        };
        
        // BESİN ARAMA
        function searchFood() {
            const searchTerm = document.getElementById('foodSearch').value.toLowerCase();
            const categoryFilter = document.getElementById('categoryFilter').value;
            const resultsContainer = document.getElementById('searchResults');
            
            resultsContainer.innerHTML = '';
            
            const results = Object.entries(foodDatabase).filter(([key, food]) => {
                const matchesSearch = key.includes(searchTerm) || food.name.toLowerCase().includes(searchTerm);
                const matchesCategory = !categoryFilter || food.category === categoryFilter;
                return matchesSearch && matchesCategory;
            });
            
            results.forEach(([key, food]) => {
                const foodItem = createFoodItem(food);
                resultsContainer.appendChild(foodItem);
            });
            
            if (results.length === 0) {
                resultsContainer.innerHTML = '<p style="text-align: center; opacity: 0.7;">Besin bulunamadı</p>';
            }
        }
        
        function createFoodItem(food) {
            const div = document.createElement('div');
            div.className = 'food-item';
            div.innerHTML = `
                <div class="food-name">
                    ${food.name}
                    <button class="favorite-btn" onclick="toggleFavorite('${food.name}')">⭐</button>
                </div>
                <div class="nutrition-info">
                    <span>🔥 ${food.calories} kcal</span>
                    <span>🥩 ${food.protein}g protein</span>
                    <span>🍞 ${food.carbs}g karbonhidrat</span>
                    <span>🥑 ${food.fat}g yağ</span>
                </div>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <input type="number" class="amount-input" value="100" min="1" max="1000">
                    <span>gram</span>
                    <button class="btn btn-success" onclick="addFood('${food.name}', this.previousElementSibling.previousElementSibling.value)">Ekle</button>
                </div>
            `;
            return div;
        }
        
        // FAVORİLER
        function toggleFavorite(foodName) {
            let favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
            const index = favorites.indexOf(foodName);
            
            if (index > -1) {
                favorites.splice(index, 1);
            } else {
                favorites.push(foodName);
            }
            
            localStorage.setItem('favorites', JSON.stringify(favorites));
            loadFavorites();
        }
        
        function loadFavorites() {
            const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
            const container = document.getElementById('favoritesList');
            container.innerHTML = '';
            
            favorites.forEach(foodName => {
                const food = Object.values(foodDatabase).find(f => f.name === foodName);
                if (food) {
                    const foodItem = createFoodItem(food);
                    container.appendChild(foodItem);
                }
            });
            
            if (favorites.length === 0) {
                container.innerHTML = '<p style="text-align: center; opacity: 0.7;">Henüz favori besin eklenmemiş</p>';
            }
        }
        
        // BESİN EKLEME VE TAKİP
        function addFood(foodName, amount) {
            const food = Object.values(foodDatabase).find(f => f.name === foodName);
            if (!food) return;
            
            const multiplier = amount / 100;
            const foodEntry = {
                name: food.name,
                calories: Math.round(food.calories * multiplier),
                protein: Math.round(food.protein * multiplier * 10) / 10,
                carbs: Math.round(food.carbs * multiplier * 10) / 10,
                fat: Math.round(food.fat * multiplier * 10) / 10,
                amount: amount,
                time: new Date().toLocaleTimeString()
            };
            
            let foodHistory = JSON.parse(localStorage.getItem('foodHistory') || '[]');
            foodHistory.push(foodEntry);
            localStorage.setItem('foodHistory', JSON.stringify(foodHistory));
            
            loadFoodHistory();
            updateDashboard();
        }
        
        function loadFoodHistory() {
            const foodHistory = JSON.parse(localStorage.getItem('foodHistory') || '[]');
            const container = document.getElementById('foodList');
            container.innerHTML = '';
            
            foodHistory.forEach((food, index) => {
                const div = document.createElement('div');
                div.className = 'history-item';
                div.innerHTML = `
                    <div class="history-details">
                        <strong>${food.name}</strong> (${food.amount}g)
                        <div class="history-nutrition">
                            <span>🔥 ${food.calories} kcal</span>
                            <span>🥩 ${food.protein}g</span>
                            <span>🍞 ${food.carbs}g</span>
                            <span>🥑 ${food.fat}g</span>
                            <span>🕐 ${food.time}</span>
                        </div>
                    </div>
                    <button class="delete-btn" onclick="deleteFood(${index})">🗑️</button>
                `;
                container.appendChild(div);
            });
            
            if (foodHistory.length === 0) {
                container.innerHTML = '<p style="text-align: center; opacity: 0.7;">Henüz besin eklenmemiş</p>';
            }
        }
        
        function deleteFood(index) {
            let foodHistory = JSON.parse(localStorage.getItem('foodHistory') || '[]');
            foodHistory.splice(index, 1);
            localStorage.setItem('foodHistory', JSON.stringify(foodHistory));
            loadFoodHistory();
            updateDashboard();
        }
        
        // DASHBOARD GÜNCELLEME
        function updateDashboard() {
            const foodHistory = JSON.parse(localStorage.getItem('foodHistory') || '[]');
            
            const totals = foodHistory.reduce((acc, food) => {
                acc.calories += food.calories;
                acc.protein += food.protein;
                acc.carbs += food.carbs;
                acc.fat += food.fat;
                return acc;
            }, { calories: 0, protein: 0, carbs: 0, fat: 0 });
            
            document.getElementById('totalCalories').textContent = totals.calories;
            document.getElementById('totalProtein').textContent = totals.protein.toFixed(1);
            document.getElementById('totalCarbs').textContent = totals.carbs.toFixed(1);
            document.getElementById('totalFat').textContent = totals.fat.toFixed(1);
            document.getElementById('totalCaloriesChart').textContent = totals.calories;
            
            // Progress bar güncelleme
            const calorieTarget = parseInt(document.getElementById('calorieTarget').textContent);
            const proteinTarget = parseInt(document.getElementById('proteinTarget').textContent);
            const carbTarget = parseInt(document.getElementById('carbTarget').textContent);
            const fatTarget = parseInt(document.getElementById('fatTarget').textContent);
            
            document.getElementById('calorieProgress').style.width = Math.min((totals.calories / calorieTarget) * 100, 100) + '%';
            document.getElementById('proteinProgress').style.width = Math.min((totals.protein / proteinTarget) * 100, 100) + '%';
            document.getElementById('carbProgress').style.width = Math.min((totals.carbs / carbTarget) * 100, 100) + '%';
            document.getElementById('fatProgress').style.width = Math.min((totals.fat / fatTarget) * 100, 100) + '%';
        }
        
        // HEDEF HESAPLAMA
        function calculateTargets() {
            const age = parseInt(document.getElementById('userAge').value);
            const gender = document.getElementById('userGender').value;
            const height = parseInt(document.getElementById('userHeight').value);
            const weight = parseInt(document.getElementById('userWeight').value);
            const activity = parseFloat(document.getElementById('activityLevel').value);
            const goal = document.getElementById('goal').value;
            
            if (!age || !height || !weight) {
                alert('Lütfen tüm alanları doldurun!');
                return;
            }
            
            // BMR hesaplama (Mifflin-St Jeor formülü)
            let bmr;
            if (gender === 'male') {
                bmr = 10 * weight + 6.25 * height - 5 * age + 5;
            } else {
                bmr = 10 * weight + 6.25 * height - 5 * age - 161;
            }
            
            // TDEE hesaplama
            let tdee = bmr * activity;
            
            // Hedef kalori hesaplama
            let targetCalories;
            switch (goal) {
                case 'lose':
                    targetCalories = tdee - 500; // 0.5kg/hafta kayıp
                    break;
                case 'gain':
                    targetCalories = tdee + 500; // 0.5kg/hafta artış
                    break;
                default:
                    targetCalories = tdee;
            }
            
            // Makro hedefleri
            const proteinTarget = weight * 2.2; // kg başına 2.2g protein
            const fatTarget = (targetCalories * 0.25) / 9; // %25 yağ
            const carbTarget = (targetCalories - (proteinTarget * 4) - (fatTarget * 9)) / 4;
            
            // Hedefleri güncelle
            document.getElementById('calorieTarget').textContent = Math.round(targetCalories);
            document.getElementById('proteinTarget').textContent = Math.round(proteinTarget);
            document.getElementById('carbTarget').textContent = Math.round(carbTarget);
            document.getElementById('fatTarget').textContent = Math.round(fatTarget);
            
            updateDashboard();
            
            alert(`Hedefler hesaplandı!\nKalori: ${Math.round(targetCalories)}\nProtein: ${Math.round(proteinTarget)}g\nKarbonhidrat: ${Math.round(carbTarget)}g\nYağ: ${Math.round(fatTarget)}g`);
        }
        
        function editCalorieTarget() {
            const newTarget = prompt('Yeni kalori hedefi girin:');
            if (newTarget && !isNaN(newTarget)) {
                document.getElementById('calorieTarget').textContent = newTarget;
                updateDashboard();
            }
        }
        
        // VERİ YÖNETİMİ
        function exportData() {
            const data = {
                foodHistory: JSON.parse(localStorage.getItem('foodHistory') || '[]'),
                favorites: JSON.parse(localStorage.getItem('favorites') || '[]'),
                waterCount: localStorage.getItem('waterCount') || '0',
                theme: localStorage.getItem('theme') || 'light'
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = 'kalorimax-data.json';
            link.click();
            
            URL.revokeObjectURL(url);
        }
        
        function clearAllData() {
            if (confirm('Tüm veriler silinecek. Emin misiniz?')) {
                localStorage.clear();
                location.reload();
            }
        }
        
        // Enter tuşu ile arama
        document.getElementById('foodSearch').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchFood();
            }
        });
    </script>
</body>
</html> 